---
layout: post
title: Quando i backup servono...
date: '2007-10-03T07:37:00.000+02:00'
author: Mauro Servienti
tags:
- Why not...
modified_time: '2012-01-26T11:54:25.000+01:00'
blogger_id: tag:blogger.com,1999:blog-6511237790974218081.post-6766565584730181344
blogger_orig_url: http://milestone.topics.it/2007/10/quando-i-backup-servono.html
---

<span>Ieri causa gruppo di continuità un po' sottodimensionato, o meglio ho sovrastimato io le sue capacità..., il mio server casalingo si è schiantato durante lo shutdown... </span><br> <span>Purtroppo la cosa che non avevo preso in considerazione è che lo shutdown adesso è decisamente più lungo perchè le 4 macchine virtuali che sono ospitate da quel server devono essere messe in "<em>save state</em>" allungando i tempi in maniera decisamente sensibile.</span><br> <span>Sta di fatto che le conseguenze sono state poco simpatiche:</span><br> <ul> <li><strong>Exchange</strong>: morto e defunto... gli store non vengono più montati ed <em>eseutil</em> dice mestamente che non è che ci sia molto da fare...  </li><li><strong>Team Foundation Server</strong>: molto peggio, l'intero disco virtuale che ospita i dati del TFS è corrotto... (infilata notevole di smadonnamenti vari <img alt="Open-mouthed" src="http://messenger.msn.com/MMM2006-04-19_17.00/Resource/emoticons/teeth_smile.gif">)</li></ul> <span>Non mi faccio prendere dal panico (balle mi stavo... <img alt="Open-mouthed" src="http://messenger.msn.com/MMM2006-04-19_17.00/Resource/emoticons/teeth_smile.gif">) e tiro fuori i backup: faccio un backup settimanale dei file fisici di Virtual Server e faccio regolari backup giornalieri sia dello storage di Exchange che dei db di TFS esattamente come se fossero macchine fisiche.</span><br> <span><em>Risultato</em>:</span><br> <ul> <li>in circa 1 ora le macchine virtuali sono nuovamente operative;  </li><li>Un restore del backup di Exchange mi restituisce tutta la posta, usando poi Outlook con l'Exchange Cached Mode, la posta "scaricata" dopo l'ultimo backup era ancora sul client e alla prima connessione si è risincronizzato il tutto; </li><li>Mi sono poi dedicato a TFS effettuando il restore di tutti i db (e sono tanti) litigando un po' all'inizio con il restore del database master causa "single user mode" che non ne voleva sapere: è necessario stoppare tutti i servizi che possono aver bisogno di accedere a TFS altrimenti non avete mezzo di accedere al server. Una volta rirpistinato il master il resto è stato un gioco da ragazzi.</li></ul> <span>Adesso sto facendo qualche test per assicurarmi che ci sia tutto, mi resta solo da riallineare il lavoro fatto ieri off-line e non ci dovrebbero essere altri problemi.</span><br> <span>Mi resta una piccola maganga con i Reporting Services, che però non so se sia legata al restore o alle <a href="http://blogs.ugidotnet.org/topics/archive/2007/09/24/tfs.ex-spostare-workitem.aspx" target="_blank">pulizie di primavera di qualche giorno fa</a> in cui ho spostato massicciamente e riorganizzato un po' tutto... insomma ho un po' di "Aree & Itarations" che i reporting services si aspettano di trovare ma che non ci sono più... o meglio non ci sono nel progetto dove vengono cercate.</span><br> <span><u>Sempre investire in una buona politica di backup</u>, sempre... meditate gente, meditate... <img alt="Open-mouthed" src="http://messenger.msn.com/MMM2006-04-19_17.00/Resource/emoticons/teeth_smile.gif"></span><br> <span>.m</span><br>