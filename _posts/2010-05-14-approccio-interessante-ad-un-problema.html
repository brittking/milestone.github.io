---
layout: post
title: Approccio interessante ad un problema…
date: '2010-05-14T13:20:00.000+02:00'
author: Mauro Servienti
tags:
- MEF
- Software Mason
modified_time: '2012-08-04T20:20:05.122+02:00'
thumbnail: https://lh4.googleusercontent.com/-7TsFXn3iqss/TzyelqT91FI/AAAAAAAABR4/V5TRXbTHA-k/s72-c/da39fcb6-2596-49c5-b70e-9eaabfab6914.png
blogger_id: tag:blogger.com,1999:blog-6511237790974218081.post-531268415989074943
blogger_orig_url: http://milestone.topics.it/2010/05/approccio-interessante-ad-un-problema.html
permalink: /2010/05/approccio-interessante-ad-un-problema.html
---

<span>…apparentemente insormontabile.</span><br>  <span>In <a href="http://www.gaia.is.it/" target="_blank">Gaia</a> abbiamo una corposa applicazione, che definirei legacy in quanto esistente dal 2000 circa, che usiamo come engine su cui appoggiare una qantità non indifferente di building block per produrre applicazioni finite per alcuni dei nostri clienti.</span><br>  <span>L’applicazione soffre di alcuni problemi architetturali che si trascina da che mondo è mondo, inevitabile direi, e uno di questi (banale per certi versi) è emerso in questi giorni.</span><br>  <span>L’applicazione invia mail usando “Smtp Client” di .Net e lo fa in svariati punti, molto svariati e molto punti :-), in settimana la pianificazione dell’installazione presso un grosso cliente ha posto un problema: la macchina di produzione è blindatissima (<a href="http://mauroservienti.blogspot.com/2010/05/figo.html" target="_blank">mica come questi</a>) talmente blindata che non ha accesso all’esterno in nessun modo se non verso un noto set di servizi (Web Services) tra cui ce ne è uno per l’invio di posta elettronica…</span><br>  <span>Il fatto che l’applicazione usi direttamente “Smtp Client” in svariati punti senza wrapparlo in nessun modo rende sostanzialmente impossibile una modifica “<em>on the fly</em>” della logica, modifica che con un accurato uso di IoC e DI sarebbe stata banale (ci stiamo lavorando alacremente), abbiamo quindi deciso di approcciare il problema dal lato opposto.</span><br>  <span><strong>Smtp Server Proxy</strong></span><br>  <span>Stamattina mi sono armato di buon ora e ho scritto, in realtà ho cercato bene su internet e ho fatto un bel po’ di composition di un sacco di roba trovata qua e la adattandola alle nostre necessità, un server smtp in C# che fa semplicemente da proxy verso un message disatcher iniettabile a runtime via MEF.</span><br>  <span>L’applicazione quindi non dovrà essere minimamente modificata ma semplicemente configurata per usare come smtp server il nostro proxy il quale al ricevimento di ogni messaggio non farà altro che delegare al dispatcher di turno l’invio del messaggio:</span><br>  <span><a href="https://lh6.googleusercontent.com/-09uqn-PtXFo/TzyembPgGgI/AAAAAAAABSA/AM6YyXE9rfg/90f1d6c5-0130-4f73-bcd3-faf7cb94bf72.png" rel="shadowbox"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="https://lh4.googleusercontent.com/-7TsFXn3iqss/TzyelqT91FI/AAAAAAAABR4/V5TRXbTHA-k/da39fcb6-2596-49c5-b70e-9eaabfab6914.png" width="444" height="173"></a> </span><br>  <span>MEF è tanta roba, proprio tanta, ci ho messo tre minuti tre per mettere in piedi la gestione dei plugin.</span><br>  <span>.m</span><br>  
