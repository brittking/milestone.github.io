---
layout: post
title: ISA Server 2006 e le Exchange Publishing Rule
date: '2007-04-04T14:59:00.000+02:00'
author: Mauro Servienti
tags:
- Why not...
modified_time: '2012-01-25T11:50:19.479+01:00'
blogger_id: tag:blogger.com,1999:blog-6511237790974218081.post-490809849912627267
blogger_orig_url: http://milestone.topics.it/2007/04/isa-server-2006-e-le-exchange.html
---

<span>Oggi, complice una discreta influenza, mi sono dedicato (finalmente, era qualche settimana se non addirittura mese che dovevo trovare il tempo) ad un problema che affliggeva la mia <a href="http://blogs.ugidotnet.org/topics/archive/2006/12/12/59125.aspx" target="_blank">rete interna</a>.</span><br> <span>Il problema era che non riuscivo in nessun modo a pubblicare all'esterno, attraverso ISA Server, ne OWA ne tantomeno l'accesso RPC over HTTP per permettere ai client outlook di connettersi senza problemi. Dopo i primi tentativi ottenevo sempre un errore del tipo "...invalid server principal name..." dopo l'autenticazione da parte di ISA Server.</span><br> <span>Grazie al supporto via messenger di <a href="http://blogs.ugidotnet.org/dotnethoughts/" target="_blank">Igor</a>, avevo cominciato ad affrontare il problema senza però giungere ad una vera soluzione. Oggi finalmente ce l'ho fatta! pubblico qui il giro del fumo sia per me che per i posteri :-D</span><br> <span>Ho seguito alla lettera tutte le indicazioni del seguente articolo di <a href="http://www.isaserver.org/Thomas_Shinder/" target="_blank">Tom Shinder</a>:</span><br> <span><a title="http://www.isaserver.org/tutorials/ISA-Firewall-Publishing-OWA-RPC-HTTP-Single-IP-Address-Part1.html" href="http://www.isaserver.org/tutorials/ISA-Firewall-Publishing-OWA-RPC-HTTP-Single-IP-Address-Part1.html">http://www.isaserver.org/tutorials/ISA-Firewall-Publishing-OWA-RPC-HTTP-Single-IP-Address-Part1.html</a></span><br> <span>Con una differenza, nel mio caso il nome del server interno (Exchange) e il FQDN utilizzato per connettersi dall'etserno sono diversi quindi ho un doppio certificato digitale, il primo usato per stabilire una connessione sicura tra ISA e Exchange e il secondo per una connessione sicura tra il client e ISA. </span><br> <span>Una volta configurato ISA secondo le istruzioni e adeguando il "Listener" alla mia configurazione tutto sembrava funzionare correttamente, o meglio l'errore non era più relativo ai certificati ma ISA droppava la connessione dopo <em>n</em> secondi lamentando un numero di richieste http superiori al consentito... :-S</span><br> <span>la soluzione si è presentata per caso, dopo aver smanettato un po' con la configurazione di ISA e non aver ottenuto nulla mi sono dedicato all'IIS del server di Exchange, la soluzione finale è stata disabilitare la "Forms Authentication" dal System Manager di Exchange nella sezione Protocols\HTTP, una volta fatto questo dalla Form di autenticazione di ISA si passa correttamente alle pagine di OWA.</span><br> <span>Evviva niente più VPN per accedere alla posta dall'esterno!! :-D</span><br> <span>Adesso mi mancano i test per verificare le funzionalità di Outlook in "RPC over HTTP", domani faccio qualche prova "<em>scroccando la rete del cliente che mi ospita</em>" ;-)</span><br> <span>.m</span><br>