---
layout: post
title: “Run as administrator” direttamente su un file
date: '2010-09-29T13:30:00.000+02:00'
author: Mauro Servienti
tags:
- Why not...
modified_time: '2012-08-04T19:58:08.991+02:00'
thumbnail: https://lh4.googleusercontent.com/-lAKw5aZS4bE/T0SkapGx1XI/AAAAAAAABuQ/e0nc6A49Q2Q/s72-c/wlEmoticon-openmouthedsmile_2_7.png
blogger_id: tag:blogger.com,1999:blog-6511237790974218081.post-3843255344412946513
blogger_orig_url: http://milestone.topics.it/2010/09/run-as-administrator-direttamente-su-un.html
---

<span>L’unica cosa che trovo abbastanza noiosa di UAC su Windows 7, è veramente l’unica per il resto UAC è la manna dal cielo, è che come developer devo lanciare Visual Studio come Administrator ogni qualvolta ho bisogno di debuggare un “qualcosa” che ad esempio gira dentro IIS…e ogni sacrosanta volta mi dimentico di fare “Run as Administrator” e: apro, impreco, chiudo e riapro Visual Studio <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-openmouthedsmile" alt="Open-mouthed smile" src="https://lh4.googleusercontent.com/-lAKw5aZS4bE/T0SkapGx1XI/AAAAAAAABuQ/e0nc6A49Q2Q/wlEmoticon-openmouthedsmile_2_7.png"></span><br>  <span>Quello che mi sono sempre chiesto è: perchè non posso fare “Run as Administrator” direttamente di una Solution, o più in generale di un qualsiasi file e lasciare che sia il sistema operativo a fare “Run as Administrator” del processo?</span><br>  <span>Insomma questo:</span><br>  <span><a href="https://lh4.googleusercontent.com/-wMiRz8pf1Jg/T0SkcPhP26I/AAAAAAAABug/j6O6JT8TMJk/image_2_7.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://lh6.googleusercontent.com/-aKsCVsYEH4k/T0SkbKnhqNI/AAAAAAAABuY/w0KvUrxTfWU/image_thumb_8.png" width="244" height="98"></a></span><br>  <span>Si può fare <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-openmouthedsmile" alt="Open-mouthed smile" src="859acac3-3eaf-43a8-be6e-d0b5f2a17658">, non è un foto-montaggio <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smilewithtongueout" alt="Smile with tongue out" src="https://lh3.googleusercontent.com/-KNluCUUDUGY/T0SkdHp-qaI/AAAAAAAABuk/Q7kYBA4cH_k/wlEmoticon-smilewithtongueout_2_7.png">, armatevi di “regedit” (a vostro rischio e pericolo ovviamente) e andate alla ricerca, in HKEY_CLASSES_ROOT, della chiave “.sln” dovreste trovare una cosa del tipo:</span><br>  <span><a href="https://lh4.googleusercontent.com/-nbD0BtCSDWY/T0SkfmdN7hI/AAAAAAAABu4/glk5wqIfLZk/image_4_6.png"><img style="background-image: none; border-right-width: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://lh6.googleusercontent.com/-Ud40lCwy3DI/T0Skd3meAMI/AAAAAAAABuw/COYcNyDbc_M/image_thumb_1_6.png" width="244" height="90"></a></span><br>  <span>a questo punto cercate “VisualStudio.Launcher.sln” che è il processo responsabile di capire al doppio click su un file “.sln” quale versione di Visual Studio debba essere eseguita (nel caso ce ne sia più d’una installata)</span><br>  <span><a href="https://lh5.googleusercontent.com/-YELUmXDS_nA/T0SkhPaEESI/AAAAAAAABvI/miRzVGaPc4s/image_6_3.png"><img style="background-image: none; border-right-width: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://lh3.googleusercontent.com/-1pGZPicWlNc/T0SkgbGtfvI/AAAAAAAABvA/rvsnlDfyoLQ/image_thumb_2_4.png" width="244" height="119"></a></span><br>  <span>Aggiungete una chiave “runas”, figlia di “Shell”, con a sua volta “Command” come figlia, impostate come valore di default di runas/command lo stesso di open/command:</span><br>  <span><a href="https://lh3.googleusercontent.com/-BpKZ-U6dNgc/T0SkjOn6D2I/AAAAAAAABvU/PS_zHDoM2HI/image_10_1.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://lh5.googleusercontent.com/-_hlZcSVrBns/T0SkiSNLazI/AAAAAAAABvM/BSSkOksjTwU/image_thumb_4_2.png" width="484" height="44"></a></span><br>  <span>infine aggiungete una valore “HasLUAShield” a runas:</span><br>  <span><a href="https://lh6.googleusercontent.com/-VeVUnG_Nzvw/T0SklsXrzaI/AAAAAAAABvo/eD4bTuQt2Dc/image_12.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://lh3.googleusercontent.com/-gLo-xXFBZvA/T0Skj0SDUOI/AAAAAAAABvg/SnL2QiDIjls/image_thumb_5_1.png" width="244" height="52"></a></span><br>  <span>al fine di visualizzare lo “scudino” di UAC, e il gioco è fatto <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smilewithtongueout" alt="Smile with tongue out" src="d6a3c0e0-d00c-4c2f-bb73-6220890d2793">, purtroppo non funziona con gli shortcut “pinnati” nella task bar di Windows 7:</span><br>  <span><a href="https://lh6.googleusercontent.com/-y5PDpsU0-kA/T0Skn63Gr8I/AAAAAAAABv4/UpX1MDW25y8/image_14.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://lh6.googleusercontent.com/-tnC6CW9kodc/T0Skm6hSo5I/AAAAAAAABvw/eXn4uqG42fU/image_thumb_6_1.png" width="244" height="178"></a></span><br>  <span>Se qualcuno ha un lampo di genio faccia un fischio.</span><br>  <span>.m</span><br>